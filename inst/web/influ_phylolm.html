<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>influ_phylolm. sensiPhy 0.2.0</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="
Gustavo Paterno &amp; Gijsbert D.A. Werner
">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="#">sensiPhy 0.2.0</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Index</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div class="container">
      <header>
        
      </header>
      
      <h1>Influential species detection - Phylogenetic Linear Regression</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><div>influ_phylolm(formula, data, phy, model&nbsp;=&nbsp;"lambda", cutoff&nbsp;=&nbsp;2, track&nbsp;=&nbsp;TRUE, ...)</div></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>formula</dt>
      <dd>The model formula</dd>
      <dt>data</dt>
      <dd>Data frame containing species traits with row names matching tips
in <code>phy</code>.</dd>
      <dt>phy</dt>
      <dd>A phylogeny (class 'phylo') matching <code>data</code>.</dd>
      <dt>model</dt>
      <dd>The phylogenetic model to use (see Details). Default is <code>lambda</code>.</dd>
      <dt>cutoff</dt>
      <dd>The cutoff value used to identify for influential species
(see Details)</dd>
      <dt>track</dt>
      <dd>Print a report tracking function progress (default = TRUE)</dd>
      <dt>...</dt>
      <dd>Further arguments to be passed to <code>phylolm</code></dd>
    </dl>
    
    <div class="Value">
      <h2>Value</h2>

      <p><dl>
The function <code>influ_phylolm</code> returns a list with the following
components:</p>
  
      <p><code>cutoff</code>: The value selected for <code>cutoff</code></p>
  
      <p><code>formula</code>: The formula</p>
  
      <p><code>full.model.estimates</code>: Coefficients, aic and the optimised
value of the phylogenetic parameter (e.g. <code>lambda</code>) for the full model
without deleted species.</p>
  
      <p><code>influential_species</code>: List of influential species, both
based on standardised difference in interecept and in the slope of the
regression. Species are ordered from most influential to less influential and
only include species with a standardised difference > <code>cutoff</code>.</p>
  
      <p><code>influ.model.estimates</code>: A data frame with all simulation
estimates. Each row represents a deleted species. Reported are the calculated
regression intercept (<code>intercept</code>), difference between simulation
intercept and full model intercept (<code>DFintercept</code>), the standardised
difference (<code>sDFintercept</code>), the percentage change in intercept compared
to the full model (<code>intercept.perc</code>) and intercept p-value
(<code>pval.intercept</code>). All of these are also reported for the regression
slope (<code>DFslope</code> etc.). Additonally, model aic value (<code>AIC</code>) and
the optimised value (<code>optpar</code>) of the phylogenetic parameter
(e.g. <code>kappa</code> or <code>lambda</code>, depends on phylogeneticmodel used) are
reported.</p>
  
      <p><code>data</code>: Original full dataset.</p>
  
      <p><code>errors</code>: Species where deletion resulted in errors.
</dl></p>
  
    </div>

    <div class="Description">
      <h2>Description</h2>

      <p>Performs leave-one-out deletion analyis for phylogenetic linear regression,
and detects influential species.</p>
  
    </div>

    <div class="Details">
      <h2>Details</h2>

      <p>This function sequentially removes one species at a time, fits a phylogenetic
linear regression model using <code><a href='http://www.inside-r.org/packages/cran/phylolm/docs/phylolm'>phylolm</a></code>, stores the
results and detects influential species.</p>
  
      <p>All phylogenetic models from <code>phylolm</code> can be used, i.e. <code>BM</code>,
<code>OUfixedRoot</code>, <code>OUrandomRoot</code>, <code>lambda</code>, <code>kappa</code>,
<code>delta</code>, <code>EB</code> and <code>trend</code>. See ?<code>phylolm</code> for details.</p>
  
      <p><code>influ_phylolm</code> detects influential species based on the standardised
difference in intercept and/or slope when removing a given species compared
to the full model including all species. Species with a standardised difference
above the value of <code>cutoff</code> are identified as influential. The default
value for the cutoff is 2 standardised differences change.</p>
  
      <p>Currently, this function can only implement simple linear models (i.e. $trait~
predictor$). In the future we will implement more complex models.</p>
  
      <p>Output can be visualised using <code>sensi_plot</code>.</p>
  
    </div>

    <div class="References">
      <h2>References</h2>

      <p>Here still: reference to phylolm paper + our own?</p>
  
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'>library(sensiPhy)

# Loading data and phylogeny:
data(alien)
trait &lt;- alien$data
phy &lt;- alien$phy[[1]]

# Run sensitivity analysis (influential species)
out &lt;- influ_phylolm( log10(Mass) ~ log10(range), data = trait, phy = phy)
</div>
<strong class='warning'>Warning message:
NA&#39;s in response or predictor, rows with NA&#39;s were removed</strong>
<strong class='warning'>Warning message:
Some phylogeny tips do not match species in data,species were dropped from phylogeny or data</strong>
<strong class='message'>Used dataset has  51  species that match data and phylogeny</strong>
<div class='output'>[1] &quot;1 / 51&quot;
[1] &quot;2 / 51&quot;
[1] &quot;3 / 51&quot;
[1] &quot;4 / 51&quot;
[1] &quot;5 / 51&quot;
[1] &quot;6 / 51&quot;
[1] &quot;7 / 51&quot;
[1] &quot;8 / 51&quot;
[1] &quot;9 / 51&quot;
[1] &quot;10 / 51&quot;
[1] &quot;11 / 51&quot;
[1] &quot;12 / 51&quot;
[1] &quot;13 / 51&quot;
[1] &quot;14 / 51&quot;
[1] &quot;15 / 51&quot;
[1] &quot;16 / 51&quot;
[1] &quot;17 / 51&quot;
[1] &quot;18 / 51&quot;
[1] &quot;19 / 51&quot;
[1] &quot;20 / 51&quot;
[1] &quot;21 / 51&quot;
[1] &quot;22 / 51&quot;
[1] &quot;23 / 51&quot;
[1] &quot;24 / 51&quot;
[1] &quot;25 / 51&quot;
[1] &quot;26 / 51&quot;
[1] &quot;27 / 51&quot;
[1] &quot;28 / 51&quot;
[1] &quot;29 / 51&quot;
[1] &quot;30 / 51&quot;
[1] &quot;31 / 51&quot;
[1] &quot;32 / 51&quot;
[1] &quot;33 / 51&quot;
[1] &quot;34 / 51&quot;
[1] &quot;35 / 51&quot;
[1] &quot;36 / 51&quot;
[1] &quot;37 / 51&quot;
[1] &quot;38 / 51&quot;
[1] &quot;39 / 51&quot;
[1] &quot;40 / 51&quot;
[1] &quot;41 / 51&quot;
[1] &quot;42 / 51&quot;
[1] &quot;43 / 51&quot;
[1] &quot;44 / 51&quot;
[1] &quot;45 / 51&quot;
[1] &quot;46 / 51&quot;
[1] &quot;47 / 51&quot;
[1] &quot;48 / 51&quot;
[1] &quot;49 / 51&quot;
[1] &quot;50 / 51&quot;
[1] &quot;51 / 51&quot;
</div>
<strong class='message'>No errors found. All single deletions were performed and stored successfully. Please, check outpu$influ.model.estimates.</strong>
<div class='input'>
# Check most influential species for slope and intercept:
summary(out)
</div>
<div class='output'>$`Influential species for the Slope`
[1] &quot;Lepus_arcticus&quot; &quot;Capra_hircus&quot;  

$`Slope Estimates`
  Species removed     Slope    DFslope Change(%)         Pval
1  Lepus_arcticus 0.4287865 0.06660245      18.4 1.441385e-06
2    Capra_hircus 0.4205894 0.05840536      16.1 8.938528e-07

$`Influential species for the Intercept`
[1] &quot;Didelphis_marsupialis&quot; &quot;Lepus_arcticus&quot;        &quot;Sorex_cinereus&quot;        &quot;Capra_hircus&quot;         

$`Intercept Estimates`
        Species removed Intercept DFintercept Change(%)         Pval
1 Didelphis_marsupialis  3.647453  0.05790859       1.6 2.059043e-09
2        Lepus_arcticus  3.643745  0.05420063       1.5 1.065329e-09
3        Sorex_cinereus  3.637555  0.04800998       1.3 5.137809e-11
4          Capra_hircus  3.635387  0.04584196       1.3 2.356100e-10

</div>
<div class='input'>
# Plot results:
sensi_plot(out)
</div>
<p><img src='influ_phylolm-10.png' alt='' width='540' height='400' /></p></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>influ_phylolm</li>
    </ul>
    <ul>
      
    </ul> -->
      
    <h2>See also</h2>
    
<code><a href='http://www.inside-r.org/packages/cran/phylolm/docs/phylolm'>phylolm</a></code>, <code><a href='samp_phylolm.html'>samp_phylolm</a></code>,
<code><a href='influ_phyloglm.html'>influ_phyloglm</a></code>,<code><a href='sensi_plot.html'>sensi_plot</a></code>

    
    <h2>Author</h2>
    
Gustavo Paterno & Gijsbert D.A. Werner

    
  </div>
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>
<p>Built by <a href="https://github.com/hadley/staticdocs">staticdocs</a>. Styled with <a href="http://twitter.github.com/bootstrap">bootstrap</a>.</p>
      </footer>
    </div>
  </body>
</html>